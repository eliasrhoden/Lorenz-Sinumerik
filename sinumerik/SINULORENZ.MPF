; Live simulation of a Lorenz system
; 2021.11.20: E.R.
;**************************
DEF REAL STATE[3], DELTA, STATE_PLUS[3]
DEF INT INK,NR_POINTS

EXTERN LORENZ_RUKU4(VAR REAL[3], VAR REAL[3], REAL)

; Simulation params
NR_POINTS = 1500
DELTA = 0.02

; Initial condition
STATE[0] = -1;1
STATE[1] = 0;1
STATE[2] = 22;30

G94 F=100
G0 X=STATE[0] Y=STATE[1] Z=STATE[2]
;M0
STOPRE
FOR INK=0 TO NR_POINTS
	LORENZ_RUKU4(STATE,STATE_PLUS,DELTA)
	G1 X=STATE_PLUS[0] Y=STATE_PLUS[1] Z=STATE_PLUS[2]
	;M0
    ;STOPRE
	STATE[0] = STATE_PLUS[0]
	STATE[1] = STATE_PLUS[1]
	STATE[2] = STATE_PLUS[2]
ENDFOR

M30

